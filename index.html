<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Watch Report</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <div style="text-align:center;">
      <img src="/images/WatchReport.png"/>
    </div>
    <div id="news-container" class="news-grid"></div>
  </div>

  <script>
    async function loadNews() {
      try {
        const response = await fetch('data/news.json');
        const news = await response.json();
        const container = document.getElementById('news-container');

        if (news.length === 0) {
          container.innerHTML = '<p>No news articles found.</p>';
          return;
        }

        const youtubeSources = [
          "Teddy Baldassarre",
          "Jenni Elle",
          "Nico Leonard",
          "The Time Teller",
          "Andrew Morgan",
          "Horological Society of New York"
        ];

        const formatDate = (isoString) => {
          const date = new Date(isoString);
          return date.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
          });
        };

        const createCard = (item, isTop = false) => {
          const isYouTube = youtubeSources.includes(item.source);
          const card = document.createElement('div');
          card.className = isTop ? 'news-card top-story' : 'news-card';

          const thumbnail = item.thumbnail
            ? `<a href="${item.link}" target="_blank"><img src="${item.thumbnail}" alt="${item.title}"/></a>`
            : '';

          const titleText = isYouTube ? `(VIDEO) ${item.title}` : item.title;
          const formattedDate = formatDate(item.published);
          const sourceWithDate = `${item.source} | ${formattedDate}`;

          card.innerHTML = `
            ${thumbnail}
            <h2><a href="${item.link}" target="_blank">${titleText}</a></h2>
            <p>${sourceWithDate}</p>
          `;
          return card;
        };

        // Top story
        container.appendChild(createCard(news[0], true));

        // Remaining stories
        news.slice(1).forEach(item => {
          container.appendChild(createCard(item));
        });

      } catch (error) {
        console.error("Error loading news:", error);
        document.getElementById('news-container').innerHTML = '<p>Unable to load news.</p>';
      }
    }

    loadNews();
  </script>
</body>
</html>
